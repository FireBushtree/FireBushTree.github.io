# 从输入URL到页面加载发生了什么

1. DNS解析
2. 建立TCP/IP连接
3. 服务器接受请求并响应数据
4. 浏览器收到响应， 解析和渲染页面

## 针对以上步骤进行的优化

### DNS解析
由于DNS解析的过程， 也会造成网络开销， 所以资源可以适量减少部署在过多的域名上

### 建立TCP/IP连接
每一次TCP/IP握手都需要造成开销，且每一次数据往返的时间跟地理位置有关系。
优化： 在不同的地区部署CDN， 减少数据往返的时间
      适量增大TCP的拥塞窗口

### 服务器接受请求并响应数据
减少页面重定向， 因为每一次重定向又要发生上述步骤

### 浏览器收到响应， 解析和渲染页面

#### 浏览器加载资源

碰到`css`, `js`, `img`等资源会请求资源， 发生上述步骤。

##### 建立连接阶段
http1.1开启长连接， 多个资源的请求， 可以复用一个TCP连接

##### 加载资源阶段
尽可能少的发起网络请求
优化： 小图片图片使用base64
      图片合成为一张， 雪碧图
      图片使用`webp`, `svg`等图片格式， 小而清晰

浏览器会同时向服务器建立多个连接， 并行请求资源， 就算开启了长连接也是串行的， 针对同一域名， 连接
数量有限制， 可以将静态资源部署与其他域名下

##### 资源下载阶段
资源越小， 加载的肯定越快
优化： nginx开启gzip
      webpack进行打包优化
      使用合适尺寸的图片
      减少或不适用cookie

##### 资源请求结束
优化： 合理利用浏览器缓存

#### 解析和渲染

html => dom， css => cssdom， 两个合并形成render tree渲染页面

优化 html => 尽可能少的标签嵌套
    css  => 放在head中， 进行预加载， 减少回流
            减少选择器的层级嵌套
    js   => 放在body下面
            使用defer
            分包加载， 按需引入， vue-router动态组件加载
            尽量少使用引起回流和重绘的方法
            操作dom， 使用documentFragment合并dom操作
